WITH GERAL AS (
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_MTZ.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%' union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F01.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F02.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F04.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F05.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F06.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F07.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F08.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F10.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F11.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F12.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F13.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F14.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F15.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F16.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F17.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F18.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F19.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F20.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F21.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F22.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F23.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F24.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F25.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F26.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F27.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F28.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F30.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F31.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'	union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F32.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%' union
SELECT CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao,Situacao FROM Wms_F33.dbo.PedidosCab WHERE TipoPedido LIKE 'Transf%'
)
SELECT CASE WHEN Situacao = 1 THEN 'Geração de Exp' WHEN Situacao = 4 THEN 'Ag. Separação' WHEN Situacao = 7 THEN 'Ag. Conferênica' ELSE 'Sem 'END AS 'Situação Pedido', CASE
WHEN CodFilial = 1 THEN 'F001 Bezerra (CE) (V)'
WHEN CodFilial = 3 THEN 'F007 Comercial (CE) (V)'
WHEN CodFilial = 4 THEN 'F005 Messejana (CE) (V)'
WHEN CodFilial = 6 THEN 'F000 Matriz (CE) (V)'
WHEN CodFilial = 8 THEN 'F004 Atacado (CE) (A) (CD)'
WHEN CodFilial = 16 THEN 'F011 M Salazar (CE) (V)'
WHEN CodFilial = 18 THEN 'F012 Tabuleta (PI) (V)'
WHEN CodFilial = 22 THEN 'F016 M Rosa (PI) (V)'
WHEN CodFilial = 24 THEN 'F017 Maranguape (CE) (A) (CD)'
WHEN CodFilial = 26 THEN 'F023 Comprida (PI) (V)'
WHEN CodFilial = 50 THEN 'F024 Osorio P (CE) (V)'
WHEN CodFilial = 51 THEN 'F025 Real Copagre (PI) (V)'
WHEN CodFilial = 10 THEN 'F008 H Jorge (CE) (V)'
WHEN CodFilial = 20 THEN 'F014 Tintas (CE) (V)'
WHEN CodFilial = 23 THEN 'F018 Bosch (CE) (A)'
WHEN CodFilial = 46 THEN 'F021 Natal (RN) (V)'
WHEN CodFilial = 5 THEN 'F006 Importados (CE) (V)'
WHEN CodFilial = 25 THEN 'F019 Teresina (PI) (A) (CD)'
WHEN CodFilial = 2 THEN 'F002 Ant.Sales (CE) (V)'
WHEN CodFilial = 19 THEN 'F013 Maracanau (CE) (V)'
WHEN CodFilial = 52 THEN 'F026 Atacado RN (RN) (A) (CD)'
WHEN CodFilial = 54 THEN 'F027 Messejana 2 (CE) (V)'
WHEN CodFilial = 56 THEN 'F030 Garantia (CE)'
WHEN CodFilial = 58 THEN 'F032 Papicu (CE) (V)'
WHEN CodFilial = 15 THEN 'F010 Ol Paiva (CE) (V)'
WHEN CodFilial = 21 THEN 'F015 Atacadinho (PI) (A)'
WHEN CodFilial = 44 THEN 'F020 Jose Walter (CE) (V)'
WHEN CodFilial = 49 THEN 'F022 Caucaia (CE) (V)'
WHEN CodFilial = 55 THEN 'F028 Barra do Ceara (CE) (V)'
WHEN CodFilial = 57 THEN 'F031 Recife (PE) (A) (CD)'
WHEN CodFilial = 59 THEN 'Itaitinga (CE) (V)'
ELSE 'Sem'END AS 'Lojas', CodFilial,CodPedidoCab,NumDoc,DtGeracao,DtExpedicao FROM GERAL WHERE DtGeracao >='2023-05-01' /* and Situacao in ('1','4','7') */ order by [Situação Pedido],Lojas,DtGeracao




